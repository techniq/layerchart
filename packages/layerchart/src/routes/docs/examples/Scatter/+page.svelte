<script lang="ts">
  import { scaleTime, scaleThreshold } from 'd3-scale';
  import { format } from 'date-fns';
  import { formatDate, PeriodType } from '@layerstack/utils';

  import { Axis, Chart, Highlight, Labels, Points, Svg, Tooltip } from 'layerchart';

  import Preview from '$lib/docs/Preview.svelte';
  import Blockquote from '$lib/docs/Blockquote.svelte';
  import { createDateSeries } from '$lib/utils/genData.js';

  const data = createDateSeries({ min: 10, max: 100, value: 'integer' });
</script>

<h1>Examples</h1>

<Blockquote>
  See also: <a href="/docs/components/ScatterChart">ScatterChart</a> for simplified examples
</Blockquote>

<h2>Basic</h2>

<Preview {data}>
  <div class="h-[300px] p-4 border rounded-sm">
    <Chart
      {data}
      x="date"
      xScale={scaleTime()}
      y="value"
      yDomain={[0, null]}
      yNice
      padding={{ left: 16, bottom: 24 }}
    >
      <Svg>
        <Axis placement="left" grid rule />
        <Axis placement="bottom" rule />
        <Points class="fill-primary/10 stroke-primary" />
      </Svg>
    </Chart>
  </div>
</Preview>

<h2>With Tooltip and Highlight</h2>

<Preview {data}>
  <div class="h-[300px] p-4 border rounded-sm">
    <Chart
      {data}
      x="date"
      xScale={scaleTime()}
      y="value"
      yDomain={[0, null]}
      yNice
      padding={{ left: 16, bottom: 24 }}
      tooltip={{ mode: 'bisect-x' }}
    >
      <Svg>
        <Axis placement="left" grid rule />
        <Axis placement="bottom" rule />
        <Points class="fill-primary/10 stroke-primary" />
        <Highlight points lines />
      </Svg>

      <Tooltip.Root>
        {#snippet children({ data })}
          <Tooltip.Header>{format(data.date, 'eee, MMMM do')}</Tooltip.Header>
          <Tooltip.List>
            <Tooltip.Item label="value" value={data.value} />
          </Tooltip.List>
        {/snippet}
      </Tooltip.Root>
    </Chart>
  </div>
</Preview>

<h2>With Labels</h2>

<Preview {data}>
  <div class="h-[300px] p-4 border rounded-sm">
    <Chart
      {data}
      x="date"
      xScale={scaleTime()}
      y="value"
      yDomain={[0, null]}
      yNice
      padding={{ left: 16, bottom: 24 }}
    >
      <Svg>
        <Axis placement="left" grid rule />
        <Axis placement="bottom" rule />
        <Points class="fill-primary/10 stroke-primary" />
        <Labels format="integer" offset={10} />
      </Svg>
    </Chart>
  </div>
</Preview>

<h2>Color via scale</h2>

<h3>red (0-49), yellow (50-89), green (90+)</h3>

<Preview {data}>
  <div class="h-[300px] p-4 border rounded-sm">
    <Chart
      {data}
      x="date"
      xScale={scaleTime()}
      y="value"
      yDomain={[0, null]}
      yNice
      c="value"
      cScale={scaleThreshold()}
      cDomain={[50, 90]}
      cRange={['var(--color-danger)', 'var(--color-warning)', 'var(--color-success)']}
      padding={{ left: 16, bottom: 24 }}
    >
      <Svg>
        <Axis placement="left" grid rule />
        <Axis placement="bottom" rule />
        <Points class="stroke-surface-content/50" />
      </Svg>
    </Chart>
  </div>
</Preview>
